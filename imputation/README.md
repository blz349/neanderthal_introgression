# Fairfax imputation code

### Requirements:
PLINK 1.9

VCFtools

BCFtools 1.3

R and packages:
* ggplot2
* data.table

Python3 and modules:
* pandas

---

### Description of code

    fairfax_imputation.md
This document describes submitting Fairfax genotyping data for imputation through the Sanger Imputation Service. Genotyping data was first checked against the HRC reference panel using Will Rayner (McCarthy)'s script and converted to a VCF file, which was then uploaded onto the Sanger Imputation Service server for imputation against the HRC reference panel. After imputation, the downloaded data was filtered for calls with an info score > 0.9 and QC filtered by MAF, HWE and call rate. Finally, variants within high LD regions were removed and the data was saved in PLINK binary (bed/bim) format. Plots were created in R to visualise the imputation info score range, genotyping and imputation coverage and number of variants after each stage of imputation filtering. The code detailed in this document was adapted from Katie Burnham.

    LD_imputed_fairfax.md
This documents describes extracting LD r<sup>2</sup> values for imputed SNPs that crossover with Neanderthal-introgressed SNPs versus Fairfax eQTLs for European populations using the 1000 genomes dataset. r<sup>2</sup> values < 0.9 excluded and for SNPs linked to >1 Fairfax eQTLs, the eQTL with the highest r<sup>2</sup> value was kept. The data was saved in CSV format.

---

### Results

`fairfax_eqtl_genotyping_NoLongRangeLD (bed/bim/fam)`, which is saved under: /well/jknight/shiyao/data/extreme_response/imputation/info_0.9/  
contains the list of variants after info score filtering, QC filtering and removal of high LD regions from variants generated by imputation of Fairfax genotyping data against the HRC reference panel.

Implutation plots generated include:
* `Imputation_infoscore.png` showing range of info scores for imputed variants
* `Imputation_infoscore_MAF.png` showing median info scores for different MAFs for imputed variants
* `Genotyping_coverage.png` showing range of chromosomal positions for genotyped variants
* `Genotyping_coverage_chromosome.png` showing number of genotyped variants per chromosome
* `Imputation_overview.png` showing number of variants per chromosome for each stage of genotyping/imputation/ filtering
* `GenotypingvsImputationCoverage.png` comparing range of chromosomal positions between genotyped and imputed variants

`LD_intersected_fairfax_0.9.csv`, which is saved under: /well/jknight/shiyao/data/extreme_response/LD_imputed/  
contains the chromosomes, positions and IDs of the SNP (found in both imputed and neanderthal datasets) and the eQTL it is in LD with and the r<sup>2</sup> value, for each of the 2195 SNPs in LD with a Fairfax eQTL.

---

### Data

Genotyping data and list of eQTLs from:
* Fairfax BP *et al.* Innate immune activity conditions the effect of regulatory variants upon monocyte gene expression. *Science* 2014 **343**:1246949.  
&nbsp;

HRC reference panel from:
* [McCarthy tools](https://www.well.ox.ac.uk/~wrayner/tools/index.html#Checking)  
&nbsp;

High LD regions from:
* Anderson CA *et al.* Data quality control in genetic case-control association studies. *Nature protocols* 2010 **5**(9):1564-73.  
&nbsp;

1000 genomes phase 3 VCF files from:
* [Data | 1000 genomes](https://www.internationalgenome.org/data/)  
&nbsp;

Neanderthal-introgressed SNPs from:
1. Dannemann M, Prufer K & Kelso J. Functional implications of Neandertal introgression in modern humans. *Genome Biol* 2017 **18**:61.
2. Simonti CN *et al.* The phenotypic legacy of admixture between modern humans and Neandertals. *Science* 2016 **351**:737-41.  
