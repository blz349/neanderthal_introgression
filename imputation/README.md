# Fairfax imputation code

### Requirements:
PLINK 1.9

VCFtools

BCFtools 1.3

R

R packages:
* ggplot2
* data.table

---

### Description of code

    fairfax_imputation.md
This document describes submitting Fairfax genotyping data for imputation through the Sanger Imputation Service. Genotyping data was first checked against the HRC reference panel using Will Rayner (McCarthy)'s script and converted to a VCF file, which was then uploaded onto the Sanger Imputation Service server for imputation against the HRC reference panel. After imputation, the downloaded data was filtered for calls with an info score > 0.9 and QC filtered by MAF, HWE and call rate. Finally, variants within high LD regions were removed and the data was saved in PLINK binary (bed/bim) format. Plots were created in R to visualise the imputation info score range, genotyping and imputation coverage and number of variants after each stage of imputation filtering. The code detailed in this document was adapted from Katie Burnham.

---

### Results

`fairfax_eqtl_genotyping_NoLongRangeLD (bed/bim/fam)`, which is saved under: /well/jknight/shiyao/data/extreme_response/imputation/info_0.9/  
contains the list of variants after info score filtering, QC filtering and removal of high LD regions from variants generated by imputation of Fairfax genotyping data against the HRC reference panel.

Plots generated include:
* `Imputation_infoscore.png` showing range of info scores for imputed variants
* `Imputation_infoscore_MAF.png` showing median info scores for different MAFs for imputed variants
* `Genotyping_coverage.png` showing range of chromosomal positions for genotyped variants
* `Genotyping_coverage_chromosome.png` showing number of genotyped variants per chromosome
* `Imputation_overview.png` showing number of variants per chromosome for each stage of genotyping/imputation/ filtering
* `GenotypingvsImputationCoverage.png` comparing range of chromosomal positions between genotyped and imputed variants

---

### Data

Genotyping data from:
* Fairfax BP *et al.* Innate immune activity conditions the effect of regulatory variants upon monocyte gene expression. *Science* 2014 **343**:1246949.  
&nbsp;

HRC reference panel from:
* [McCarthy tools](https://www.well.ox.ac.uk/~wrayner/tools/index.html#Checking)  
&nbsp;

High LD regions from:
* Anderson CA *et al.* Data quality control in genetic case-control association studies. *Nature protocols* 2010 **5**(9):1564-73. 


